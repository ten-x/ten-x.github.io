var app=function(document,$){"use strict";var docElem=document.documentElement,_userAgentInit=function(){docElem.setAttribute("data-useragent",navigator.userAgent)},_init=function(){$(document).foundation(),_userAgentInit()},startSperm=function(){function headTransform(d){return"translate("+d.path[0]+")rotate("+Math.atan2(d.vy,d.vx)*degrees+")"}function tailPath(d){return"M"+d.join("L")}var width=innerWidth,height=innerHeight,n=10,m=12,degrees=180/Math.PI,spermatozoa=d3.range(n).map(function(){var x=Math.random()*width,y=Math.random()*height;return{vx:2*Math.random()-1,vy:2*Math.random()-1,path:d3.range(m).map(function(){return[x,y]}),count:0}}),svg=d3.select("body").append("svg").attr("width",width).attr("height",height),g=svg.selectAll("g").data(spermatozoa).enter().append("g"),head=g.append("ellipse").attr("rx",6.5).attr("ry",4);g.append("path").datum(function(d){return d.path.slice(0,3)}).attr("class","mid"),g.append("path").datum(function(d){return d.path}).attr("class","tail");var tail=g.selectAll("path");d3.timer(function(){for(var i=-1;++i<n;){var spermatozoon=spermatozoa[i],path=spermatozoon.path,dx=spermatozoon.vx,dy=spermatozoon.vy,x=path[0][0]+=dx,y=path[0][1]+=dy,speed=Math.sqrt(dx*dx+dy*dy),count=10*speed,k1=-5-speed/3;(0>x||x>width)&&(spermatozoon.vx*=-1),(0>y||y>height)&&(spermatozoon.vy*=-1);for(var j=0;++j<m;){var vx=x-path[j][0],vy=y-path[j][1],k2=Math.sin(((spermatozoon.count+=count)+3*j)/300)/speed;path[j][0]=(x+=dx/speed*k1)-dy*k2,path[j][1]=(y+=dy/speed*k1)+dx*k2,speed=Math.sqrt((dx=vx)*dx+(dy=vy)*dy)}}head.attr("transform",headTransform),tail.attr("d",tailPath)})};return{init:_init,startSperm:startSperm}}(document,jQuery);!function(){"use strict";app.init()}();